# 安装

> https://mirrors.tuna.tsinghua.edu.cn/CRAN/src/base/R-4/R-4.1.0.tar.gz 
> https://mirrors.tuna.tsinghua.edu.cn/CRAN/src/base/R-3/R-3.6.3.tar.gz

## 安装R3
```
wget -c https://mirrors.tuna.tsinghua.edu.cn/CRAN/src/base/R-3/R-3.6.2.tar.gz
--enable-R-shlib --enable-memory-profiling --prefix= #对于R3版本
make -j 8
make install 
```

> https://mirrors.tuna.tsinghua.edu.cn/CRAN/src/base/R-3/R-3.6.3.tar.gz

## 安装R4
```
--enable-R-shlib --enable-memory-profiling --prefix= --with-pcre1 #对于R4版本以上
#$ ./configure --enable-R-shlib --enable-memory-profiling --prefix=`pwd` --with-pcre1
```

报错1
```
configure: error: libcurl >= 7.28.0 library and headers are required with support for https
```
去掉conda环境再安装

报错2
```
checking whether PCRE support suffices... no
configure: error: PCRE2 library and headers are required, or use --with-pcre1 and PCRE >= 8.32 with UTF-8 support
```

```
wget https://ftp.pcre.org/pub/pcre/pcre-8.40.tar.gz --no-check-certificate
$ tar -zxvf pcre-8.40.tar.gz
$ cd pcre-8.40
$ ./configure --prefix=/disks/software/pcre-8.4 --enable-utf8
$ make -j3 && make install

export PATH="/public/frasergen/MED/software/zhangbo/R/pcre-8.40:$PATH"
[fszb@hlogin09 R-4.1.0]$ ./configure --enable-R-shlib=yes --enable-memory-profiling --prefix=`pwd` --with-pcre1
```
> https://cran.r-project.org/bin/linux/ubuntu/README.html
> https://mirrors.tuna.tsinghua.edu.cn/CRAN/src/base/R-4/
> https://mirrors.tuna.tsinghua.edu.cn/CRAN/src/base/R-4/R-4.1.0.tar.gz 


```
[fszb@hlogin09 R-4.1.0]$ ./configure --enable-R-shlib --enable-memory-profiling --prefix=`pwd` --with-pcre1

```

```
checking whether PCRE support suffices... no
configure: error: PCRE2 library and headers are required, or use --with-pcre1 and PCRE >= 8.32 with UTF-8 support
```

```
wget https://ftp.pcre.org/pub/pcre/pcre-8.40.tar.gz --no-check-certificate
$ tar -zxvf pcre-8.40.tar.gz
$ cd pcre-8.40
$ ./configure --prefix=/disks/software/pcre-8.4 --enable-utf8
$ make -j3 && make install

export PATH="/public/frasergen/MED/software/zhangbo/R/pcre-8.40:$PATH"
[fszb@hlogin09 R-4.1.0]$ ./configure --enable-R-shlib=yes --enable-memory-profiling --prefix=`pwd` --with-pcre1
```


## 镜像切换

```
rm(list = ls()) 
options()$repos 
options()$BioC_mirror
options(BioC_mirror="https://mirrors.ustc.edu.cn/bioc/")
options("repos" = c(CRAN="https://mirrors.tuna.tsinghua.edu.cn/CRAN/"))
options()$repos 
options()$BioC_mirror

source("https://bioconductor.org/biocLite.R")
biocLite("TCGAbiolinks")
library("TCGAbiolinks")
```

## windows下更新R
可以通过Rstudio 更新R，也可以在R console中更新,只需要三步：
```
1，install.packages("installr ")
2，require(installr)
3,updateR()
```

## 安装r中的报错
https://www.jianshu.com/p/edb234eed915

### 
```
configure: error: libcurl >= 7.28.0 library and headers are required with support for https
```
https://zhuanlan.zhihu.com/p/44841273

### png包 
```

install.packages('png')
```
https://stackoverflow.com/questions/47424249/unable-to-install-the-package-png-on-r-possible-conflict-with-anaconda/50935430

###  magick包安装
#### 使用conda安装
```
conda install -c conda-forge r-magick

conda install -c conda-forge imagemagick

conda install -c conda-forge libmagic
conda install -c conda-forge/label/gcc7 libmagic
conda install -c conda-forge/label/cf201901 libmagic
conda install -c conda-forge/label/cf202003 libmagic
```
#### 不适用conda安装
```
export PKG_CONFIG_PATH=/local_data1/MED/programs/R/ImageMagick-7.0.10-34/lib/pkgconfig/:$PKG_CONFIG_PATH
export LD_LIBRARY_PATH=/local_data1/MED/programs/R/ImageMagick-7.0.10-34/lib/:$LD_LIBRARY_PATH
devtools::install_github("ropensci/magick")
```

```
两种情况，如果你只是想加上某库的pkg，则选择下面其一：
export PKG_CONFIG_PATH=/usr/lib/pkgconfig/ 
或者 
export PKG_CONFIG_LIBDIR=/usr/lib/pkgconfig/ 
如果你想覆盖掉原来的pkg,选择后者。因为：
PKG_CONFIG_LIBDIR的优先级比 PKG_CONFIG_PATH 高，所以会覆盖PKG_CONFIG_PATH的设置。
也可以使用如下命令，注意一定要放在PKG_CONFIG_PATH的前面，这样才能首先读取。
 $ export PKG_CONFIG_PATH=/usr/lib/pkgconfig/:$PKG_CONFIG_PATH
 
可以通过下面命令查看
$ echo $PKG_CONFIG_PATH
```

### R包安装中出现诸如“non-zero exit status”情况的报错信息，
https://www.jianshu.com/p/4beb3d34ced2
```
unlink("C:/software/R/R-4.0.2/library/00LOCK-backports", recursive = TRUE).

```

## .libPaths()
https://stackoverflow.com/questions/15217758/remove-a-library-from-libpaths-permanently-without-rprofile-site

###   libpng16.so.16: cannot open shared object file: No such file or directory
```
https://sourceforge.net/projects/libpng/files/
```

### unit包安装
```
#Configuration failed because libudunits2.so was not found. Try installing:
$ wget -c https://artifacts.unidata.ucar.edu/repository/downloads-udunits/udunits-2.2.28.tar.gz
$ tar xf udunits-2.2.26.tar.gz
$ #configure --prefix=`pwd` && make && make install

# 方法一
#install.packages(
# "udunits2",
#   configure.args = '--with-udunits2-include=/public/frasergen/MED/software/R/R_dependency/udunits-2.2.28/include'
#)


# 方法二
#如果是conda安装 该怎么找路径 > config <- c(units="--with-udunits2-lib=/path/to/home/directory/miniconda3/lib --with-udunits2-include=/path/to/home/directory/miniconda3/include")

> config <- c(units="--with-udunits2-lib=/public/frasergen/MED/software/R/R_dependency/udunits-2.2.28/lib --with-udunits2-include=/public/frasergen/MED/software/R/R_dependency/udunits-2.2.28/include")
> options(configure.args=config)
> install.packages("units")
```
还是失败了`libudunits2.so.0: cannot open shared object file: No such file or directory`

```
> Sys.getenv("LD_LIBRARY_PATH")
udunits_dir = "/public/frasergen/MED/software/R/R_dependency/udunits-2.2.28"
Sys.setenv(LD_LIBRARY_PATH=paste0(Sys.getenv("LD_LIBRARY_PATH"), ":", udunits_dir, "/local/lib"))
install.packages("udunits2", 
                 type = "source",
                 configure.args = c(paste0("--with-udunits2-include=", udunits_dir, "/local/include"), 
                                    paste0("--with-udunits2-lib=", udunits_dir, "/local/lib")),
                 repos = "http://cran.rstudio.com")
dyn.load(paste0(udunits_dir, "/local/lib/libudunits2.so.0"))
install.packages("units", repos = "http://cran.rstudio.com",
             configure.args = c(paste0("--with-udunits2-include=", udunits_dir, "/local/include"), 
                                paste0("--with-udunits2-lib=", udunits_dir, "/local/lib")))

```

